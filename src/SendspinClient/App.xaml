<Application x:Class="SendspinClient.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:SendspinClient"
             xmlns:tb="http://www.hardcodet.net/taskbar"
             xmlns:converters="clr-namespace:SendspinClient.Resources.Converters"
             ShutdownMode="OnExplicitShutdown">
    <Application.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Resources/Styles/Colors.xaml"/>
                <ResourceDictionary Source="Resources/Styles/Controls.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- Converters for tray context menu (with text labels) -->
            <converters:PlayPauseTextConverter x:Key="PlayPauseTextConverter"/>
            <converters:MuteIconConverter x:Key="MuteIconConverter"/>

            <!-- System Tray Icon -->
            <tb:TaskbarIcon x:Key="TrayIcon"
                            IconSource="pack://application:,,,/Resources/Icons/sendspinTray.png"
                            ToolTipText="{Binding TrayToolTip}"
                            LeftClickCommand="{Binding ToggleWindowCommand}"
                            DoubleClickCommand="{Binding ShowWindowCommand}">
                <tb:TaskbarIcon.ContextMenu>
                    <ContextMenu>
                        <!-- Playback Controls -->
                        <MenuItem Header="{Binding IsPlaying, Converter={StaticResource PlayPauseTextConverter}}"
                                  Command="{Binding PlayPauseCommand}"/>
                        <MenuItem Header="⏭ Next" Command="{Binding NextTrackCommand}"/>
                        <MenuItem Header="⏮ Previous" Command="{Binding PreviousTrackCommand}"/>
                        <Separator/>

                        <!-- Volume Controls -->
                        <MenuItem Header="{Binding IsMuted, Converter={StaticResource MuteIconConverter}}"
                                  Command="{Binding ToggleMuteCommand}"/>
                        <MenuItem Header="Volume" IsEnabled="False">
                            <MenuItem.Icon>
                                <TextBlock Text="{Binding Volume, StringFormat={}{0}%}"
                                           VerticalAlignment="Center" FontSize="10"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>

                        <!-- Window and Exit -->
                        <MenuItem Header="Show Window" Command="{Binding ShowWindowCommand}"/>
                        <MenuItem Header="Exit" Command="{Binding ExitApplicationCommand}"/>
                    </ContextMenu>
                </tb:TaskbarIcon.ContextMenu>
            </tb:TaskbarIcon>
        </ResourceDictionary>
    </Application.Resources>
</Application>
